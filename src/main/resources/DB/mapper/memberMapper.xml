<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

 <mapper namespace="com.iu.s5.member.MemberDAO">
 
 	<sql id="search">
  		like '%'||#{search}||'%'
  	</sql>
  	
  	<select id="memberCount" parameterType="com.iu.s5.member.memberPage.Pager" resultType="java.lang.Long">
  		select count(id) from member
  <where>
  			<if test="kind == 'id'">
  				ID <include refid="search"></include>
  			</if>
  			
  			<if test="kind == 'na'">
  				NAME <include refid="search"></include>
  			</if>
  			
  			<if test="kind == 'ph'">
  				PHONE <include refid="search"></include>
  			</if>
  			
  			<if test="kind == 'em'">
  				EMAIL <include refid="search"></include>
  			</if>
  		</where>
  		
  	</select>
  	
  	
  	<select id="memberList" parameterType="com.iu.s5.member.memberPage.Pager" resultType="com.iu.s5.member.MemberVO">
  	select * from(select N.*, rownum R from(select * from member where 
	<choose>
		<when test="kind=='id'">
			ID
		</when>
		<when test="kind=='na'">
			NAME
		</when>
		<when test="kind=='ph'">
			PHONE
		</when>
		<otherwise>
			EMAIL
		</otherwise>
	</choose>
	like '%'||#{search}||'%') N)where R between #{startRow} and #{lastRow} 
  	
  	</select>
  	
  	
 
<update parameterType="com.iu.s5.member.MemberVO" id="memberUpdate">
Update member set email=#{email},phone=#{phone},age=#{age} where id=#{id} 
</update>


<delete parameterType="java.lang.Long" id="memberDelete">
delete member where id=#{id} 
</delete>

<insert parameterType="com.iu.s5.member.MemberVO" id="memberJoin">
insert into member values(#{id},#{pw},#{name},#{email},#{phone},#{age}) 
</insert>

<select parameterType="java.lang.Long" id="memberLogin" resultType="com.iu.s5.member.MemberVO">
select * from member where id=#{id} and pw=#{pw} 
</select>

</mapper>